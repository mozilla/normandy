

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Workflow &mdash; Normandy 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Contract Tests" href="api-tests.html" />
    <link rel="prev" title="Developer Setup" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Normandy
          

          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html">Developer Setup</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-tests">Running Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linting">Linting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-your-local-instance">Updating Your Local Instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-documentation">Building the Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-new-dependencies">Adding New Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preprocessing-assets-with-webpack">Preprocessing Assets with Webpack</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api-tests.html">API Contract Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="coverage.html">Test Coverage</a></li>
<li class="toctree-l2"><a class="reference internal" href="feature-experiments.html">Feature Experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="remote-settings.html">Remote Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="ci.html">Continuous Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../qa/index.html">QA Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ops/index.html">Operations Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Normandy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Developer Documentation</a> &raquo;</li>
        
      <li>Workflow</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/dev/workflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="workflow">
<h1>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline">¶</a></h1>
<p>The following is a list of things you’ll probably need to do at some point while
working on Normandy.</p>
<div class="section" id="running-tests">
<h2>Running Tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h2>
<p>You can run the automated test suite with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>py.test
</pre></div>
</div>
<p>In Python, to run the tests with code coverage run the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install pytest-coverage
py.test --cov-report html --cov-report term-missing --cov normandy
open htmlcov/index.html
</pre></div>
</div>
<p>JavaScript tests can be run with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>karma start
</pre></div>
</div>
</div>
<div class="section" id="linting">
<h2>Linting<a class="headerlink" href="#linting" title="Permalink to this headline">¶</a></h2>
<p>You will need to <a class="reference internal" href="install.html#therapist-install"><span class="std std-ref">install Therapist</span></a> for linting. If
you have installed pre-commit hook linting will take place with every commit,
however there may be times you want to run the linters manually.</p>
<p>To run the linters on all files that you have changed or added:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>therapist use lint
</pre></div>
</div>
<p>To run the linters on all files in the repo:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>therapist use lint:all
</pre></div>
</div>
<p>To run the linters and attempt to fix issues in files that you have changed or
added:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>therapist use fix
</pre></div>
</div>
<p>To run the linters and attempt to fix issues in all files in the repo:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>therapist use fix:all
</pre></div>
</div>
</div>
<div class="section" id="updating-your-local-instance">
<h2>Updating Your Local Instance<a class="headerlink" href="#updating-your-local-instance" title="Permalink to this headline">¶</a></h2>
<p>When changes are merged to the main Normandy repository, you’ll want to update
your local development instance to reflect the latest version of the site. You
can use Git as normal to pull the latest changes, but if the changes add any new
dependencies or alter the database, you’ll want to install any new libraries and
run any new migrations.</p>
<p>If you’re unsure what needs to be run, it’s safe to just perform all of these
steps, as they don’t affect your setup if nothing has changed:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pull latest code (assuming you&#39;ve already checked out master).</span>
git pull origin master

<span class="c1"># Install new dependencies or update existing ones.</span>
pip install -r requirements/dev.txt
yarn install

<span class="c1"># Run database migrations.</span>
python manage.py migrate

<span class="c1"># Add any new action data (does not duplicate data).</span>
python manage.py update_actions

<span class="c1"># Update product details (does not duplicate data).</span>
python manage.py update_product_details

<span class="c1"># Update any new basic data (does not duplicate data).</span>
python manage.py initial_data

<span class="c1"># Build frontend files</span>
yarn build
</pre></div>
</div>
</div>
<div class="section" id="building-the-documentation">
<h2>Building the Documentation<a class="headerlink" href="#building-the-documentation" title="Permalink to this headline">¶</a></h2>
<p>You can build the documentation with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enter the docs/ subdirectory</span>
<span class="nb">cd</span> docs
make html
</pre></div>
</div>
<p>After running this command, the documentation should be available at
<code class="docutils literal notranslate"><span class="pre">docs/_build/html/index.html</span></code>.</p>
</div>
<div class="section" id="adding-new-dependencies">
<h2>Adding New Dependencies<a class="headerlink" href="#adding-new-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Normandy uses hashed requirements for all of our dependencies. This means
that files in the <code class="docutils literal notranslate"><span class="pre">requirements</span></code> directory includes hashes that help verify
that dependencies downloaded by pip haven’t been tampered with.</p>
<p>When adding a new dependency, you must include hashes for it. For packages that
use wheels, you will have to include hashes for all of the platforms that the
wheel supports, as they will all have different hashes. Tools like <a class="reference external" href="https://github.com/peterbe/hashin">hashin</a> can
make adding these hashes easier.</p>
<p>Dependency’s dependencies should go in <code class="docutils literal notranslate"><span class="pre">requirements/constraints.txt</span></code>.</p>
</div>
<div class="section" id="preprocessing-assets-with-webpack">
<span id="process-webpack"></span><h2>Preprocessing Assets with Webpack<a class="headerlink" href="#preprocessing-assets-with-webpack" title="Permalink to this headline">¶</a></h2>
<p>We use <a class="reference external" href="http://webpack.github.io/">Webpack</a> to create asset bundles of static resources. These assets are
only used for legacy actions, and can be ignored if you aren’t working with
Firefox clients older than Firefox 66. You can build an asset bundle by
running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn build
</pre></div>
</div>
<p>You can also run the watch command to automatically rebuild your bundles as you
make changes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn watch
</pre></div>
</div>
<p>Running the command with <code class="docutils literal notranslate"><span class="pre">--env.update-actions</span></code> will automatically call
<code class="docutils literal notranslate"><span class="pre">manage.py</span> <span class="pre">update_actions</span></code> when action code is built.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yarn watch --env.update-actions
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api-tests.html" class="btn btn-neutral float-right" title="API Contract Tests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="install.html" class="btn btn-neutral float-left" title="Developer Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2018, Mozilla Foundation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>